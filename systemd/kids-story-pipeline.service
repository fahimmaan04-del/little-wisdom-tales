[Unit]
Description=Little Wisdom Tales - Autonomous 21-Channel YouTube Pipeline
Documentation=file:///mnt/projects/youtube/SETUP_GUIDE.md
After=network-online.target ollama.service
Wants=network-online.target

[Service]
Type=simple
User=ubuntu-22
Group=ubuntu-22
WorkingDirectory=/mnt/projects/youtube
ExecStart=/mnt/projects/youtube/start_pipeline.sh batch
Restart=always
RestartSec=60
StartLimitIntervalSec=3600
StartLimitBurst=10

# Environment
Environment=HOME=/home/ubuntu-22
Environment=PATH=/usr/local/bin:/usr/bin:/bin
EnvironmentFile=-/mnt/projects/youtube/.env

# Logging
StandardOutput=append:/mnt/projects/youtube/data/logs/service.log
StandardError=append:/mnt/projects/youtube/data/logs/service-error.log

# Resource limits - generous for GPU workloads
LimitNOFILE=65536
MemoryMax=32G
TimeoutStartSec=300
TimeoutStopSec=60

# Auto-restart on failure, never give up
WatchdogSec=3600
RestartPreventExitStatus=

[Install]
WantedBy=multi-user.target
